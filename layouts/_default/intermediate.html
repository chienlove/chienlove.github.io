<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tải xuống {{ .Title }}</title>
    <link rel="stylesheet" href="/css/intermediate.css">
</head>
<body>
    <header>
        <h1>Đang chuẩn bị tải xuống...</h1>
    </header>

    <main>
        <p>Chúng tôi đang chuẩn bị liên kết tải xuống cho bạn. Vui lòng đợi một chút.</p>
        <p id="countdown">10</p>
    </main>

    <footer>
        <p>&copy; {{ now.Year }} Tool Jailbreak. Tất cả các quyền được bảo lưu.</p>
    </footer>

    <script>
        // Lấy URL tải xuống từ phiên bản đầu tiên
let downloadUrl = '';
let intermediatePageUrl = '';
{{ range .Params.versions }}
    downloadUrl = "{{ .plistUrl }}";
    intermediatePageUrl = "{{ .intermediate_page_url }}".replace(":appId", "{{ .appId }}");
    {{ break }}
{{ end }}

// Kiểm tra nếu URL tồn tại
if (intermediatePageUrl) {
    console.log('Intermediate Page URL:', intermediatePageUrl); // Xem giá trị trong console
    let countdown = 10;
    const interval = setInterval(function() {
        countdown--;
        document.getElementById('countdown').innerText = countdown;
        if (countdown <= 0) {
            clearInterval(interval);
            if (intermediatePageUrl) {
                window.location.href = intermediatePageUrl; // Chuyển hướng đến trang trung gian
            } else {
                document.getElementById('countdown').innerText = "Lỗi: Không có URL trung gian!";
            }
        }
    }, 1000);
} else {
    document.getElementById('countdown').innerText = "Lỗi: Không tìm thấy URL trung gian!";
}
    </script>
</body>
</html>