{"version":3,"sources":["@wordpress/components/src/mobile/keyboard-aware-flat-list/use-text-input-offset.native.js"],"names":["useTextInputOffset","scrollEnabled","scrollViewRef","getTextInputOffset","caret","caretY","textInput","RCTAztecView","InputState","getCurrentFocusedElement","Promise","resolve","current","measureLayout","_x","y","_width","height","caretYOffset","Math","round","abs"],"mappings":";;;;;;;;;AAGA;;AACA;;AAJA;AACA;AACA;;AAIA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACe,SAASA,kBAAT,CAA6BC,aAA7B,EAA4CC,aAA5C,EAA4D;AAC1E,QAAMC,kBAAkB,GAAG,0BAC1B,MAAQC,KAAR,IAAmB;AAClB,UAAM;AAAEC,MAAAA,MAAM,GAAG;AAAX,QAAoBD,KAApB,aAAoBA,KAApB,cAAoBA,KAApB,GAA6B,EAAnC;;AACA,UAAME,SAAS,GACdC,0BAAaC,UAAb,CAAwBC,wBAAxB,EADD;;AAGA,WAAO,IAAIC,OAAJ,CAAeC,OAAF,IAAe;AAClC,UACCT,aAAa,CAACU,OAAd,IACAN,SADA,IAEAL,aAFA,IAGAI,MAAM,KAAK,IAJZ,EAKE;AACDC,QAAAA,SAAS,CAACO,aAAV,CACCX,aAAa,CAACU,OADf,EAEC,CAAEE,EAAF,EAAMC,CAAN,EAASC,MAAT,EAAiBC,MAAjB,KAA6B;AAC5B,gBAAMC,YAAY,GACjB;AACA;AACA;AACA;AACAb,UAAAA,MAAM,IAAI,CAAV,IAAeA,MAAM,GAAGY,MAAxB,GACGF,CAAC,GAAGV,MADP,GAEGU,CAAC,GAAGE,MAPR;AAQAN,UAAAA,OAAO,CAAEQ,IAAI,CAACC,KAAL,CAAYD,IAAI,CAACE,GAAL,CAAUH,YAAV,CAAZ,CAAF,CAAP;AACA,SAZF,EAaC,MAAMP,OAAO,CAAE,IAAF,CAbd;AAeA,OArBD,MAqBO;AACNA,QAAAA,OAAO,CAAE,IAAF,CAAP;AACA;AACD,KAzBM,CAAP;AA0BA,GAhCyB,EAiC1B,CAAEV,aAAF,EAAiBC,aAAjB,CAjC0B,CAA3B;AAoCA,SAAO,CAAEC,kBAAF,CAAP;AACA","sourcesContent":["/**\n * WordPress dependencies\n */\nimport RCTAztecView from '@wordpress/react-native-aztec';\nimport { useCallback } from '@wordpress/element';\n\n/** @typedef {import('@wordpress/element').RefObject} RefObject */\n/**\n * Hook that calculates the currently focused TextInput's current\n * caret Y coordinate position.\n *\n * @param {boolean}   scrollEnabled Whether the scroll is enabled or not.\n * @param {RefObject} scrollViewRef ScrollView reference.\n * @return {[Function]} Function to get the current TextInput's offset.\n */\nexport default function useTextInputOffset( scrollEnabled, scrollViewRef ) {\n\tconst getTextInputOffset = useCallback(\n\t\tasync ( caret ) => {\n\t\t\tconst { caretY = null } = caret ?? {};\n\t\t\tconst textInput =\n\t\t\t\tRCTAztecView.InputState.getCurrentFocusedElement();\n\n\t\t\treturn new Promise( ( resolve ) => {\n\t\t\t\tif (\n\t\t\t\t\tscrollViewRef.current &&\n\t\t\t\t\ttextInput &&\n\t\t\t\t\tscrollEnabled &&\n\t\t\t\t\tcaretY !== null\n\t\t\t\t) {\n\t\t\t\t\ttextInput.measureLayout(\n\t\t\t\t\t\tscrollViewRef.current,\n\t\t\t\t\t\t( _x, y, _width, height ) => {\n\t\t\t\t\t\t\tconst caretYOffset =\n\t\t\t\t\t\t\t\t// For cases where the caretY value is -1\n\t\t\t\t\t\t\t\t// we use the y + height value, e.g the current\n\t\t\t\t\t\t\t\t// character index is not valid or out of bounds\n\t\t\t\t\t\t\t\t// see https://github.com/wordpress-mobile/AztecEditor-iOS/blob/4d0522d67b0056ac211466caaa76936cc5b4f947/Aztec/Classes/TextKit/TextView.swift#L762\n\t\t\t\t\t\t\t\tcaretY >= 0 && caretY < height\n\t\t\t\t\t\t\t\t\t? y + caretY\n\t\t\t\t\t\t\t\t\t: y + height;\n\t\t\t\t\t\t\tresolve( Math.round( Math.abs( caretYOffset ) ) );\n\t\t\t\t\t\t},\n\t\t\t\t\t\t() => resolve( null )\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tresolve( null );\n\t\t\t\t}\n\t\t\t} );\n\t\t},\n\t\t[ scrollEnabled, scrollViewRef ]\n\t);\n\n\treturn [ getTextInputOffset ];\n}\n"]}