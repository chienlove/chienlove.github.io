{"version":3,"sources":["@wordpress/components/src/higher-order/with-notices/index.tsx"],"names":["v4","uuid","forwardRef","useState","useMemo","createHigherOrderComponent","NoticeList","OriginalComponent","Component","props","ref","noticeList","setNoticeList","noticeOperations","createNotice","notice","noticeToAdd","id","current","createErrorNotice","msg","status","content","removeNotice","filter","removeAllNotices","propsOut","noticeUI","length","isForwardRef","render"],"mappings":";;;AAAA;AACA;AACA;AACA,SAASA,EAAE,IAAIC,IAAf,QAA2B,MAA3B;AAEA;AACA;AACA;;AACA,SAASC,UAAT,EAAqBC,QAArB,EAA+BC,OAA/B,QAA8C,oBAA9C;AACA,SAASC,0BAAT,QAA2C,oBAA3C;AAEA;AACA;AACA;;AACA,OAAOC,UAAP,MAAuB,mBAAvB;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAeD,0BAA0B,CAAIE,iBAAF,IAAyB;AACnE,WAASC,SAAT,CACCC,KADD,EAECC,GAFD,EAGE;AACD,UAAM,CAAEC,UAAF,EAAcC,aAAd,IAAgCT,QAAQ,CAE3C,EAF2C,CAA9C;AAIA,UAAMU,gBAAgB,GAAGT,OAAO,CAE7B,MAAM;AACR,YAAMU,YAAqE,GACxEC,MAAF,IAAc;AACb,cAAMC,WAAW,GAAGD,MAAM,CAACE,EAAP,GACjBF,MADiB,GAEjB,EAAE,GAAGA,MAAL;AAAaE,UAAAA,EAAE,EAAEhB,IAAI;AAArB,SAFH;AAGAW,QAAAA,aAAa,CAAIM,OAAF,IAAe,CAAE,GAAGA,OAAL,EAAcF,WAAd,CAAjB,CAAb;AACA,OANF;;AAQA,aAAO;AACNF,QAAAA,YADM;AAENK,QAAAA,iBAAiB,EAAIC,GAAF,IAAW;AAC7B;AACAN,UAAAA,YAAY,CAAE;AACbO,YAAAA,MAAM,EAAE,OADK;AAEbC,YAAAA,OAAO,EAAEF;AAFI,WAAF,CAAZ;AAIA,SARK;AASNG,QAAAA,YAAY,EAAIN,EAAF,IAAU;AACvBL,UAAAA,aAAa,CAAIM,OAAF,IACdA,OAAO,CAACM,MAAR,CAAkBT,MAAF,IAAcA,MAAM,CAACE,EAAP,KAAcA,EAA5C,CADY,CAAb;AAGA,SAbK;AAcNQ,QAAAA,gBAAgB,EAAE,MAAM;AACvBb,UAAAA,aAAa,CAAE,EAAF,CAAb;AACA;AAhBK,OAAP;AAkBA,KA7B+B,EA6B7B,EA7B6B,CAAhC;AA+BA,UAAMc,QAAQ,GAAG,EAChB,GAAGjB,KADa;AAEhBE,MAAAA,UAFgB;AAGhBE,MAAAA,gBAHgB;AAIhBc,MAAAA,QAAQ,EAAEhB,UAAU,CAACiB,MAAX,GAAoB,CAApB,IACT,cAAC,UAAD;AACC,QAAA,SAAS,EAAC,4BADX;AAEC,QAAA,OAAO,EAAGjB,UAFX;AAGC,QAAA,QAAQ,EAAGE,gBAAgB,CAACU;AAH7B;AALe,KAAjB;AAaA,WAAOM,YAAY,GAClB,cAAC,iBAAD,eAAwBH,QAAxB;AAAmC,MAAA,GAAG,EAAGhB;AAAzC,OADkB,GAGlB,cAAC,iBAAD,EAAwBgB,QAAxB,CAHD;AAKA;;AAED,MAAIG,YAAJ,CA5DmE,CA6DnE;;AACA,QAAM;AAAEC,IAAAA;AAAF,MAAavB,iBAAnB,CA9DmE,CA+DnE;;AACA,MAAK,OAAOuB,MAAP,KAAkB,UAAvB,EAAoC;AACnCD,IAAAA,YAAY,GAAG,IAAf;AACA,WAAO3B,UAAU,CAAEM,SAAF,CAAjB;AACA;;AACD,SAAOA,SAAP;AACA,CArEwC,EAqEtC,aArEsC,CAAzC","sourcesContent":["/**\n * External dependencies\n */\nimport { v4 as uuid } from 'uuid';\n\n/**\n * WordPress dependencies\n */\nimport { forwardRef, useState, useMemo } from '@wordpress/element';\nimport { createHigherOrderComponent } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport NoticeList from '../../notice/list';\nimport type { WithNoticeProps } from './types';\n\n/**\n * Override the default edit UI to include notices if supported.\n *\n * Wrapping the original component with `withNotices` encapsulates the component\n * with the additional props `noticeOperations` and `noticeUI`.\n *\n * ```jsx\n * import { withNotices, Button } from '@wordpress/components';\n *\n * const MyComponentWithNotices = withNotices(\n * \t( { noticeOperations, noticeUI } ) => {\n * \t\tconst addError = () =>\n * \t\t\tnoticeOperations.createErrorNotice( 'Error message' );\n * \t\treturn (\n * \t\t\t<div>\n * \t\t\t\t{ noticeUI }\n * \t\t\t\t<Button variant=\"secondary\" onClick={ addError }>\n * \t\t\t\t\tAdd error\n * \t\t\t\t</Button>\n * \t\t\t</div>\n * \t\t);\n * \t}\n * );\n * ```\n *\n * @param OriginalComponent Original component.\n *\n * @return Wrapped component.\n */\nexport default createHigherOrderComponent( ( OriginalComponent ) => {\n\tfunction Component(\n\t\tprops: { [ key: string ]: any },\n\t\tref: React.ForwardedRef< any >\n\t) {\n\t\tconst [ noticeList, setNoticeList ] = useState<\n\t\t\tWithNoticeProps[ 'noticeList' ]\n\t\t>( [] );\n\n\t\tconst noticeOperations = useMemo<\n\t\t\tWithNoticeProps[ 'noticeOperations' ]\n\t\t>( () => {\n\t\t\tconst createNotice: WithNoticeProps[ 'noticeOperations' ][ 'createNotice' ] =\n\t\t\t\t( notice ) => {\n\t\t\t\t\tconst noticeToAdd = notice.id\n\t\t\t\t\t\t? notice\n\t\t\t\t\t\t: { ...notice, id: uuid() };\n\t\t\t\t\tsetNoticeList( ( current ) => [ ...current, noticeToAdd ] );\n\t\t\t\t};\n\n\t\t\treturn {\n\t\t\t\tcreateNotice,\n\t\t\t\tcreateErrorNotice: ( msg ) => {\n\t\t\t\t\t// @ts-expect-error TODO: Missing `id`, potentially a bug\n\t\t\t\t\tcreateNotice( {\n\t\t\t\t\t\tstatus: 'error',\n\t\t\t\t\t\tcontent: msg,\n\t\t\t\t\t} );\n\t\t\t\t},\n\t\t\t\tremoveNotice: ( id ) => {\n\t\t\t\t\tsetNoticeList( ( current ) =>\n\t\t\t\t\t\tcurrent.filter( ( notice ) => notice.id !== id )\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tremoveAllNotices: () => {\n\t\t\t\t\tsetNoticeList( [] );\n\t\t\t\t},\n\t\t\t};\n\t\t}, [] );\n\n\t\tconst propsOut = {\n\t\t\t...props,\n\t\t\tnoticeList,\n\t\t\tnoticeOperations,\n\t\t\tnoticeUI: noticeList.length > 0 && (\n\t\t\t\t<NoticeList\n\t\t\t\t\tclassName=\"components-with-notices-ui\"\n\t\t\t\t\tnotices={ noticeList }\n\t\t\t\t\tonRemove={ noticeOperations.removeNotice }\n\t\t\t\t/>\n\t\t\t),\n\t\t};\n\n\t\treturn isForwardRef ? (\n\t\t\t<OriginalComponent { ...propsOut } ref={ ref } />\n\t\t) : (\n\t\t\t<OriginalComponent { ...propsOut } />\n\t\t);\n\t}\n\n\tlet isForwardRef: boolean;\n\t// @ts-expect-error - `render` will only be present when OriginalComponent was wrapped with forwardRef().\n\tconst { render } = OriginalComponent;\n\t// Returns a forwardRef if OriginalComponent appears to be a forwardRef.\n\tif ( typeof render === 'function' ) {\n\t\tisForwardRef = true;\n\t\treturn forwardRef( Component );\n\t}\n\treturn Component;\n}, 'withNotices' );\n"]}