{"version":3,"sources":["@wordpress/components/src/mobile/segmented-control/index.native.js"],"names":["View","TouchableWithoutFeedback","Text","Platform","Animated","Easing","useState","useEffect","usePreferredColorSchemeStyle","performLayoutAnimation","styles","ANIMATION_DURATION","isIOS","OS","Segment","isSelected","title","onPress","onLayout","props","isSelectedIOS","segmentStyle","segment","segmentIOS","textStyle","buttonTextDefault","buttonTextDefaultDark","selectedTextStyle","buttonTextSelected","buttonTextSelectedDark","shadowStyle","shadowIOS","SegmentedControls","segments","segmentHandler","selectedIndex","addonLeft","addonRight","selectedSegmentIndex","activeSegmentIndex","setActiveSegmentIndex","segmentsDimensions","setSegmentsDimensions","width","height","positionAnimationValue","Value","setValue","calculateEndValue","containerStyle","container","containerDark","performSwatchAnimation","index","timing","toValue","duration","easing","ease","useNativeDriver","start","paddingLeft","offset","containerIOS","widths","Object","values","map","dimension","widthsDistance","slice","widthsDistanceSum","reduce","sum","n","endValue","onHandlePress","segmentOnLayout","event","nativeEvent","layout","selectedStyle","selected","selectedDark","outlineStyle","outline","outlineIOS","row","flex","length","left"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport {\n\tView,\n\tTouchableWithoutFeedback,\n\tText,\n\tPlatform,\n\tAnimated,\n\tEasing,\n} from 'react-native';\n/**\n * WordPress dependencies\n */\nimport { useState, useEffect } from '@wordpress/element';\nimport { usePreferredColorSchemeStyle } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport { performLayoutAnimation } from '../layout-animation';\nimport styles from './style.scss';\n\nconst ANIMATION_DURATION = 200;\n\nconst isIOS = Platform.OS === 'ios';\n\nconst Segment = ( { isSelected, title, onPress, onLayout, ...props } ) => {\n\tconst isSelectedIOS = isIOS && isSelected;\n\n\tconst segmentStyle = [ styles.segment, isIOS && styles.segmentIOS ];\n\n\tconst textStyle = usePreferredColorSchemeStyle(\n\t\tstyles.buttonTextDefault,\n\t\tstyles.buttonTextDefaultDark\n\t);\n\tconst selectedTextStyle = usePreferredColorSchemeStyle(\n\t\tstyles.buttonTextSelected,\n\t\tstyles.buttonTextSelectedDark\n\t);\n\tconst shadowStyle = usePreferredColorSchemeStyle( styles.shadowIOS, {} );\n\n\treturn (\n\t\t<View style={ isSelectedIOS && shadowStyle }>\n\t\t\t<TouchableWithoutFeedback onPress={ onPress }>\n\t\t\t\t<View style={ segmentStyle } onLayout={ onLayout } { ...props }>\n\t\t\t\t\t<Text\n\t\t\t\t\t\tstyle={ [ textStyle, isSelected && selectedTextStyle ] }\n\t\t\t\t\t\tmaxFontSizeMultiplier={ 2 }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ title }\n\t\t\t\t\t</Text>\n\t\t\t\t</View>\n\t\t\t</TouchableWithoutFeedback>\n\t\t</View>\n\t);\n};\n\nconst SegmentedControls = ( {\n\tsegments,\n\tsegmentHandler,\n\tselectedIndex,\n\taddonLeft,\n\taddonRight,\n} ) => {\n\tconst selectedSegmentIndex = selectedIndex || 0;\n\tconst [ activeSegmentIndex, setActiveSegmentIndex ] =\n\t\tuseState( selectedSegmentIndex );\n\tconst [ segmentsDimensions, setSegmentsDimensions ] = useState( {\n\t\t[ activeSegmentIndex ]: { width: 0, height: 0 },\n\t} );\n\tconst [ positionAnimationValue ] = useState( new Animated.Value( 0 ) );\n\n\tuseEffect( () => {\n\t\tsetActiveSegmentIndex( selectedSegmentIndex );\n\t\tsegmentHandler( segments[ selectedSegmentIndex ] );\n\t\t// Disable reason: deferring this refactor to the native team.\n\t\t// see https://github.com/WordPress/gutenberg/pull/41166\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [] );\n\n\tuseEffect( () => {\n\t\tpositionAnimationValue.setValue(\n\t\t\tcalculateEndValue( activeSegmentIndex )\n\t\t);\n\t\t// Disable reason: deferring this refactor to the native team.\n\t\t// see https://github.com/WordPress/gutenberg/pull/41166\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [ segmentsDimensions ] );\n\n\tconst containerStyle = usePreferredColorSchemeStyle(\n\t\tstyles.container,\n\t\tstyles.containerDark\n\t);\n\n\tfunction performSwatchAnimation( index ) {\n\t\tAnimated.timing( positionAnimationValue, {\n\t\t\ttoValue: calculateEndValue( index ),\n\t\t\tduration: ANIMATION_DURATION,\n\t\t\teasing: Easing.ease,\n\t\t\tuseNativeDriver: false,\n\t\t} ).start();\n\t}\n\n\tfunction calculateEndValue( index ) {\n\t\tconst { paddingLeft: offset } = isIOS\n\t\t\t? styles.containerIOS\n\t\t\t: styles.container;\n\t\tconst widths = Object.values( segmentsDimensions ).map(\n\t\t\t( dimension ) => dimension.width\n\t\t);\n\t\tconst widthsDistance = widths.slice( 0, index );\n\t\tconst widthsDistanceSum = widthsDistance.reduce(\n\t\t\t( sum, n ) => sum + n,\n\t\t\t0\n\t\t);\n\n\t\tconst endValue = index === 0 ? 0 : widthsDistanceSum;\n\t\treturn endValue + offset;\n\t}\n\n\tfunction onHandlePress( segment, index ) {\n\t\tperformLayoutAnimation( ANIMATION_DURATION );\n\t\tsetActiveSegmentIndex( index );\n\t\tsegmentHandler( segment );\n\t\tperformSwatchAnimation( index );\n\t}\n\n\tfunction segmentOnLayout( event, index ) {\n\t\tconst { width, height } = event.nativeEvent.layout;\n\n\t\tsetSegmentsDimensions( {\n\t\t\t...segmentsDimensions,\n\t\t\t[ index ]: { width, height },\n\t\t} );\n\t}\n\n\tconst selectedStyle = usePreferredColorSchemeStyle(\n\t\tstyles.selected,\n\t\tstyles.selectedDark\n\t);\n\n\tconst width = segmentsDimensions[ activeSegmentIndex ]?.width;\n\tconst height = segmentsDimensions[ activeSegmentIndex ]?.height;\n\n\tconst outlineStyle = [ styles.outline, isIOS && styles.outlineIOS ];\n\n\treturn (\n\t\t<View style={ styles.row }>\n\t\t\t<View style={ styles.flex }>{ addonLeft }</View>\n\t\t\t<View style={ [ containerStyle, isIOS && styles.containerIOS ] }>\n\t\t\t\t{ segments.map( ( segment, index ) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<Segment\n\t\t\t\t\t\t\ttitle={ segment }\n\t\t\t\t\t\t\tonPress={ () => onHandlePress( segment, index ) }\n\t\t\t\t\t\t\tisSelected={ activeSegmentIndex === index }\n\t\t\t\t\t\t\tkey={ index }\n\t\t\t\t\t\t\tonLayout={ ( event ) =>\n\t\t\t\t\t\t\t\tsegmentOnLayout( event, index )\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\taccessibilityState={ {\n\t\t\t\t\t\t\t\tselected: activeSegmentIndex === index,\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\taccessibilityRole={ 'button' }\n\t\t\t\t\t\t\taccessibilityLabel={ segment }\n\t\t\t\t\t\t\taccessibilityHint={ `${ index + 1 } on ${\n\t\t\t\t\t\t\t\tsegments.length\n\t\t\t\t\t\t\t}` }\n\t\t\t\t\t\t/>\n\t\t\t\t\t);\n\t\t\t\t} ) }\n\t\t\t\t<Animated.View\n\t\t\t\t\tstyle={ [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\twidth,\n\t\t\t\t\t\t\tleft: positionAnimationValue,\n\t\t\t\t\t\t\theight,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tselectedStyle,\n\t\t\t\t\t\toutlineStyle,\n\t\t\t\t\t] }\n\t\t\t\t/>\n\t\t\t</View>\n\t\t\t<View style={ styles.flex }>{ addonRight }</View>\n\t\t</View>\n\t);\n};\n\nexport default SegmentedControls;\n"]}