{"version":3,"sources":["@wordpress/components/src/mobile/bottom-sheet/bottom-sheet-navigation/navigation-container.native.js"],"names":["View","Easing","NavigationContainer","DefaultTheme","createStackNavigator","useState","useContext","useMemo","useCallback","Children","useRef","cloneElement","usePreferredColorSchemeStyle","performLayoutAnimation","BottomSheetNavigationContext","BottomSheetNavigationProvider","styles","AnimationSpec","animation","config","duration","easing","ease","fadeConfig","current","cardStyle","opacity","progress","options","transitionSpec","open","close","headerShown","gestureEnabled","cardStyleInterpolator","ANIMATION_DURATION","BottomSheetNavigationContainer","children","animate","main","theme","style","Stack","context","currentHeight","setCurrentHeight","backgroundStyle","background","backgroundDark","_theme","colors","backgroundColor","setHeight","height","Math","round","screens","map","child","screen","name","otherProps","props","isNested"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { View, Easing } from 'react-native';\nimport { NavigationContainer, DefaultTheme } from '@react-navigation/native';\nimport { createStackNavigator } from '@react-navigation/stack';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tuseState,\n\tuseContext,\n\tuseMemo,\n\tuseCallback,\n\tChildren,\n\tuseRef,\n\tcloneElement,\n} from '@wordpress/element';\n\nimport { usePreferredColorSchemeStyle } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport { performLayoutAnimation } from '../../layout-animation';\nimport {\n\tBottomSheetNavigationContext,\n\tBottomSheetNavigationProvider,\n} from './bottom-sheet-navigation-context';\n\nimport styles from './styles.scss';\n\nconst AnimationSpec = {\n\tanimation: 'timing',\n\tconfig: {\n\t\tduration: 200,\n\t\teasing: Easing.ease,\n\t},\n};\n\nconst fadeConfig = ( { current } ) => {\n\treturn {\n\t\tcardStyle: {\n\t\t\topacity: current.progress,\n\t\t},\n\t};\n};\n\nconst options = {\n\ttransitionSpec: {\n\t\topen: AnimationSpec,\n\t\tclose: AnimationSpec,\n\t},\n\theaderShown: false,\n\tgestureEnabled: false,\n\tcardStyleInterpolator: fadeConfig,\n};\n\nconst ANIMATION_DURATION = 190;\n\nfunction BottomSheetNavigationContainer( {\n\tchildren,\n\tanimate,\n\tmain,\n\ttheme,\n\tstyle,\n} ) {\n\tconst Stack = useRef( createStackNavigator() ).current;\n\tconst context = useContext( BottomSheetNavigationContext );\n\tconst [ currentHeight, setCurrentHeight ] = useState(\n\t\tcontext.currentHeight || 1\n\t);\n\n\tconst backgroundStyle = usePreferredColorSchemeStyle(\n\t\tstyles.background,\n\t\tstyles.backgroundDark\n\t);\n\n\tconst _theme = theme || {\n\t\t...DefaultTheme,\n\t\tcolors: {\n\t\t\t...DefaultTheme.colors,\n\t\t\tbackground: backgroundStyle.backgroundColor,\n\t\t},\n\t};\n\n\tconst setHeight = useCallback(\n\t\t( height ) => {\n\t\t\t// The screen is fullHeight.\n\t\t\tif (\n\t\t\t\ttypeof height === 'string' &&\n\t\t\t\ttypeof height !== typeof currentHeight\n\t\t\t) {\n\t\t\t\tperformLayoutAnimation( ANIMATION_DURATION );\n\t\t\t\tsetCurrentHeight( height );\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\theight > 1 &&\n\t\t\t\tMath.round( height ) !== Math.round( currentHeight )\n\t\t\t) {\n\t\t\t\tif ( currentHeight === 1 ) {\n\t\t\t\t\tsetCurrentHeight( height );\n\t\t\t\t} else if ( animate ) {\n\t\t\t\t\tperformLayoutAnimation( ANIMATION_DURATION );\n\t\t\t\t\tsetCurrentHeight( height );\n\t\t\t\t} else {\n\t\t\t\t\tsetCurrentHeight( height );\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t// Disable reason: deferring this refactor to the native team.\n\t\t// see https://github.com/WordPress/gutenberg/pull/41166\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t\t[ currentHeight ]\n\t);\n\n\tconst screens = useMemo( () => {\n\t\treturn Children.map( children, ( child ) => {\n\t\t\tlet screen = child;\n\t\t\tconst { name, ...otherProps } = child.props;\n\t\t\tif ( ! main ) {\n\t\t\t\tscreen = cloneElement( child, {\n\t\t\t\t\t...child.props,\n\t\t\t\t\tisNested: true,\n\t\t\t\t} );\n\t\t\t}\n\t\t\treturn (\n\t\t\t\t<Stack.Screen\n\t\t\t\t\tname={ name }\n\t\t\t\t\t{ ...otherProps }\n\t\t\t\t\tchildren={ () => screen }\n\t\t\t\t/>\n\t\t\t);\n\t\t} );\n\t\t// Disable reason: deferring this refactor to the native team.\n\t\t// see https://github.com/WordPress/gutenberg/pull/41166\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [ children ] );\n\n\treturn useMemo( () => {\n\t\treturn (\n\t\t\t<View style={ [ style, { height: currentHeight } ] }>\n\t\t\t\t<BottomSheetNavigationProvider\n\t\t\t\t\tvalue={ {\n\t\t\t\t\t\tsetHeight,\n\t\t\t\t\t\tcurrentHeight,\n\t\t\t\t\t} }\n\t\t\t\t>\n\t\t\t\t\t{ main ? (\n\t\t\t\t\t\t<NavigationContainer theme={ _theme }>\n\t\t\t\t\t\t\t<Stack.Navigator screenOptions={ options }>\n\t\t\t\t\t\t\t\t{ screens }\n\t\t\t\t\t\t\t</Stack.Navigator>\n\t\t\t\t\t\t</NavigationContainer>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<Stack.Navigator screenOptions={ options }>\n\t\t\t\t\t\t\t{ screens }\n\t\t\t\t\t\t</Stack.Navigator>\n\t\t\t\t\t) }\n\t\t\t\t</BottomSheetNavigationProvider>\n\t\t\t</View>\n\t\t);\n\t\t// Disable reason: deferring this refactor to the native team.\n\t\t// see https://github.com/WordPress/gutenberg/pull/41166\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [ currentHeight, _theme ] );\n}\n\nexport default BottomSheetNavigationContainer;\n"]}