{"version":3,"sources":["@wordpress/components/src/mobile/keyboard-aware-flat-list/use-keyboard-offset.native.js"],"names":["Keyboard","useEffect","useCallback","useState","useRef","useKeyboardOffset","scrollEnabled","shouldPreventAutomaticScroll","keyboardOffset","setKeyboardOffset","timeoutRef","onKeyboardDidHide","clearTimeout","current","setTimeout","onKeyboardDidShow","endCoordinates","height","onKeyboardWillShow","willShowSubscription","showSubscription","hideSubscription","addListener","remove"],"mappings":"AAAA;AACA;AACA;AAEA,SAASA,QAAT,QAAyB,cAAzB;AAEA;AACA;AACA;;AACA,SAASC,SAAT,EAAoBC,WAApB,EAAiCC,QAAjC,EAA2CC,MAA3C,QAAyD,oBAAzD;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,eAAe,SAASC,iBAAT,CACdC,aADc,EAEdC,4BAFc,EAGb;AACD,QAAM,CAAEC,cAAF,EAAkBC,iBAAlB,IAAwCN,QAAQ,CAAE,CAAF,CAAtD;AACA,QAAMO,UAAU,GAAGN,MAAM,EAAzB;AAEA,QAAMO,iBAAiB,GAAGT,WAAW,CAAE,MAAM;AAC5C,QAAKK,4BAA4B,EAAjC,EAAsC;AACrCK,MAAAA,YAAY,CAAEF,UAAU,CAACG,OAAb,CAAZ;AACA;AACA,KAJ2C,CAM5C;AACA;;;AACAD,IAAAA,YAAY,CAAEF,UAAU,CAACG,OAAb,CAAZ;AACAH,IAAAA,UAAU,CAACG,OAAX,GAAqBC,UAAU,CAAE,MAAM;AACtCL,MAAAA,iBAAiB,CAAE,CAAF,CAAjB;AACA,KAF8B,EAE5B,GAF4B,CAA/B;AAGA,GAZoC,EAYlC,CAAEF,4BAAF,CAZkC,CAArC;AAcA,QAAMQ,iBAAiB,GAAGb,WAAW,CAAE,QAA0B;AAAA,QAAxB;AAAEc,MAAAA;AAAF,KAAwB;AAChEJ,IAAAA,YAAY,CAAEF,UAAU,CAACG,OAAb,CAAZ;AACAJ,IAAAA,iBAAiB,CAAEO,cAAc,CAACC,MAAjB,CAAjB;AACA,GAHoC,EAGlC,EAHkC,CAArC;AAKA,QAAMC,kBAAkB,GAAGhB,WAAW,CAAE,MAAM;AAC7CU,IAAAA,YAAY,CAAEF,UAAU,CAACG,OAAb,CAAZ;AACA,GAFqC,EAEnC,EAFmC,CAAtC;AAIAZ,EAAAA,SAAS,CAAE,MAAM;AAChB,QAAIkB,oBAAJ;AACA,QAAIC,gBAAJ;AACA,QAAIC,gBAAJ;;AAEA,QAAKf,aAAL,EAAqB;AACpBa,MAAAA,oBAAoB,GAAGnB,QAAQ,CAACsB,WAAT,CACtB,kBADsB,EAEtBJ,kBAFsB,CAAvB;AAIAE,MAAAA,gBAAgB,GAAGpB,QAAQ,CAACsB,WAAT,CAClB,iBADkB,EAElBP,iBAFkB,CAAnB;AAIAM,MAAAA,gBAAgB,GAAGrB,QAAQ,CAACsB,WAAT,CAClB,iBADkB,EAElBX,iBAFkB,CAAnB;AAIA,KAbD,MAaO;AAAA;;AACN,+BAAAQ,oBAAoB,UAApB,sEAAsBI,MAAtB;AACA,2BAAAH,gBAAgB,UAAhB,8DAAkBG,MAAlB;AACA,2BAAAF,gBAAgB,UAAhB,8DAAkBE,MAAlB;AACA;;AAED,WAAO,MAAM;AAAA;;AACZX,MAAAA,YAAY,CAAEF,UAAU,CAACG,OAAb,CAAZ;AACA,gCAAAM,oBAAoB,UAApB,wEAAsBI,MAAtB;AACA,4BAAAH,gBAAgB,UAAhB,gEAAkBG,MAAlB;AACA,4BAAAF,gBAAgB,UAAhB,gEAAkBE,MAAlB;AACA,KALD;AAMA,GA9BQ,EA8BN,CACFZ,iBADE,EAEFI,iBAFE,EAGFG,kBAHE,EAIFZ,aAJE,CA9BM,CAAT;AAoCA,SAAO,CAAEE,cAAF,CAAP;AACA","sourcesContent":["/**\n * External dependencies\n */\n\nimport { Keyboard } from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport { useEffect, useCallback, useState, useRef } from '@wordpress/element';\n\n/**\n * Hook that adds Keyboard listeners to get the offset space\n * when the keyboard is opened, taking into account focused AztecViews.\n *\n * @param {boolean}  scrollEnabled                Whether the scroll is enabled or not.\n * @param {Function} shouldPreventAutomaticScroll Whether to prevent scrolling when there's a Keyboard offset set.\n * @return {[number]} Keyboard offset.\n */\nexport default function useKeyboardOffset(\n\tscrollEnabled,\n\tshouldPreventAutomaticScroll\n) {\n\tconst [ keyboardOffset, setKeyboardOffset ] = useState( 0 );\n\tconst timeoutRef = useRef();\n\n\tconst onKeyboardDidHide = useCallback( () => {\n\t\tif ( shouldPreventAutomaticScroll() ) {\n\t\t\tclearTimeout( timeoutRef.current );\n\t\t\treturn;\n\t\t}\n\n\t\t// A timeout is being used to delay resetting the offset in cases\n\t\t// where the focus is changed to a different TextInput.\n\t\tclearTimeout( timeoutRef.current );\n\t\ttimeoutRef.current = setTimeout( () => {\n\t\t\tsetKeyboardOffset( 0 );\n\t\t}, 200 );\n\t}, [ shouldPreventAutomaticScroll ] );\n\n\tconst onKeyboardDidShow = useCallback( ( { endCoordinates } ) => {\n\t\tclearTimeout( timeoutRef.current );\n\t\tsetKeyboardOffset( endCoordinates.height );\n\t}, [] );\n\n\tconst onKeyboardWillShow = useCallback( () => {\n\t\tclearTimeout( timeoutRef.current );\n\t}, [] );\n\n\tuseEffect( () => {\n\t\tlet willShowSubscription;\n\t\tlet showSubscription;\n\t\tlet hideSubscription;\n\n\t\tif ( scrollEnabled ) {\n\t\t\twillShowSubscription = Keyboard.addListener(\n\t\t\t\t'keyboardWillShow',\n\t\t\t\tonKeyboardWillShow\n\t\t\t);\n\t\t\tshowSubscription = Keyboard.addListener(\n\t\t\t\t'keyboardDidShow',\n\t\t\t\tonKeyboardDidShow\n\t\t\t);\n\t\t\thideSubscription = Keyboard.addListener(\n\t\t\t\t'keyboardDidHide',\n\t\t\t\tonKeyboardDidHide\n\t\t\t);\n\t\t} else {\n\t\t\twillShowSubscription?.remove();\n\t\t\tshowSubscription?.remove();\n\t\t\thideSubscription?.remove();\n\t\t}\n\n\t\treturn () => {\n\t\t\tclearTimeout( timeoutRef.current );\n\t\t\twillShowSubscription?.remove();\n\t\t\tshowSubscription?.remove();\n\t\t\thideSubscription?.remove();\n\t\t};\n\t}, [\n\t\tonKeyboardDidHide,\n\t\tonKeyboardDidShow,\n\t\tonKeyboardWillShow,\n\t\tscrollEnabled,\n\t] );\n\treturn [ keyboardOffset ];\n}\n"]}