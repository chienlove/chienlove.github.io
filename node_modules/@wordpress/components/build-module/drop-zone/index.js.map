{"version":3,"sources":["@wordpress/components/src/drop-zone/index.tsx"],"names":["classnames","__","useState","upload","Icon","getFilesFromDataTransfer","__experimentalUseDropZone","useDropZone","useReducedMotion","__unstableMotion","motion","__unstableAnimatePresence","AnimatePresence","DropZoneComponent","className","label","onFilesDrop","onHTMLDrop","onDrop","restProps","isDraggingOverDocument","setIsDraggingOverDocument","isDraggingOverElement","setIsDraggingOverElement","type","setType","ref","event","files","dataTransfer","html","getData","length","onDragStart","_type","types","includes","onDragEnd","undefined","onDragEnter","onDragLeave","disableMotion","children","backdrop","hidden","opacity","show","transition","duration","delay","delayChildren","exit","foreground","scale","pointerEvents","classes"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { useState } from '@wordpress/element';\nimport { upload, Icon } from '@wordpress/icons';\nimport { getFilesFromDataTransfer } from '@wordpress/dom';\nimport {\n\t__experimentalUseDropZone as useDropZone,\n\tuseReducedMotion,\n} from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport {\n\t__unstableMotion as motion,\n\t__unstableAnimatePresence as AnimatePresence,\n} from '../animation';\nimport type { DropType, DropZoneProps } from './types';\nimport type { WordPressComponentProps } from '../ui/context';\n\n/**\n * `DropZone` is a component creating a drop zone area taking the full size of its parent element. It supports dropping files, HTML content or any other HTML drop event.\n *\n * ```jsx\n * import { DropZone } from '@wordpress/components';\n * import { useState } from '@wordpress/element';\n *\n * const MyDropZone = () => {\n *   const [ hasDropped, setHasDropped ] = useState( false );\n *\n *   return (\n *     <div>\n *       { hasDropped ? 'Dropped!' : 'Drop something here' }\n *       <DropZone\n *         onFilesDrop={ () => setHasDropped( true ) }\n *         onHTMLDrop={ () => setHasDropped( true ) }\n *         onDrop={ () => setHasDropped( true ) }\n *       />\n *     </div>\n *   );\n * }\n * ```\n */\nexport function DropZoneComponent( {\n\tclassName,\n\tlabel,\n\tonFilesDrop,\n\tonHTMLDrop,\n\tonDrop,\n\t...restProps\n}: WordPressComponentProps< DropZoneProps, 'div', false > ) {\n\tconst [ isDraggingOverDocument, setIsDraggingOverDocument ] =\n\t\tuseState< boolean >();\n\tconst [ isDraggingOverElement, setIsDraggingOverElement ] =\n\t\tuseState< boolean >();\n\tconst [ type, setType ] = useState< DropType >();\n\tconst ref = useDropZone( {\n\t\tonDrop( event ) {\n\t\t\tconst files = event.dataTransfer\n\t\t\t\t? getFilesFromDataTransfer( event.dataTransfer )\n\t\t\t\t: [];\n\t\t\tconst html = event.dataTransfer?.getData( 'text/html' );\n\n\t\t\t/**\n\t\t\t * From Windows Chrome 96, the `event.dataTransfer` returns both file object and HTML.\n\t\t\t * The order of the checks is important to recognise the HTML drop.\n\t\t\t */\n\t\t\tif ( html && onHTMLDrop ) {\n\t\t\t\tonHTMLDrop( html );\n\t\t\t} else if ( files.length && onFilesDrop ) {\n\t\t\t\tonFilesDrop( files );\n\t\t\t} else if ( onDrop ) {\n\t\t\t\tonDrop( event );\n\t\t\t}\n\t\t},\n\t\tonDragStart( event ) {\n\t\t\tsetIsDraggingOverDocument( true );\n\n\t\t\tlet _type: DropType = 'default';\n\n\t\t\t/**\n\t\t\t * From Windows Chrome 96, the `event.dataTransfer` returns both file object and HTML.\n\t\t\t * The order of the checks is important to recognise the HTML drop.\n\t\t\t */\n\t\t\tif ( event.dataTransfer?.types.includes( 'text/html' ) ) {\n\t\t\t\t_type = 'html';\n\t\t\t} else if (\n\t\t\t\t// Check for the types because sometimes the files themselves\n\t\t\t\t// are only available on drop.\n\t\t\t\tevent.dataTransfer?.types.includes( 'Files' ) ||\n\t\t\t\t( event.dataTransfer\n\t\t\t\t\t? getFilesFromDataTransfer( event.dataTransfer )\n\t\t\t\t\t: []\n\t\t\t\t).length > 0\n\t\t\t) {\n\t\t\t\t_type = 'file';\n\t\t\t}\n\n\t\t\tsetType( _type );\n\t\t},\n\t\tonDragEnd() {\n\t\t\tsetIsDraggingOverDocument( false );\n\t\t\tsetType( undefined );\n\t\t},\n\t\tonDragEnter() {\n\t\t\tsetIsDraggingOverElement( true );\n\t\t},\n\t\tonDragLeave() {\n\t\t\tsetIsDraggingOverElement( false );\n\t\t},\n\t} );\n\tconst disableMotion = useReducedMotion();\n\n\tlet children;\n\tconst backdrop = {\n\t\thidden: { opacity: 0 },\n\t\tshow: {\n\t\t\topacity: 1,\n\t\t\ttransition: {\n\t\t\t\ttype: 'tween',\n\t\t\t\tduration: 0.2,\n\t\t\t\tdelay: 0,\n\t\t\t\tdelayChildren: 0.1,\n\t\t\t},\n\t\t},\n\t\texit: {\n\t\t\topacity: 0,\n\t\t\ttransition: {\n\t\t\t\tduration: 0.2,\n\t\t\t\tdelayChildren: 0,\n\t\t\t},\n\t\t},\n\t};\n\n\tconst foreground = {\n\t\thidden: { opacity: 0, scale: 0.9 },\n\t\tshow: {\n\t\t\topacity: 1,\n\t\t\tscale: 1,\n\t\t\ttransition: {\n\t\t\t\tduration: 0.1,\n\t\t\t},\n\t\t},\n\t\texit: { opacity: 0, scale: 0.9 },\n\t};\n\n\tif ( isDraggingOverElement ) {\n\t\tchildren = (\n\t\t\t<motion.div\n\t\t\t\tvariants={ backdrop }\n\t\t\t\tinitial={ disableMotion ? 'show' : 'hidden' }\n\t\t\t\tanimate=\"show\"\n\t\t\t\texit={ disableMotion ? 'show' : 'exit' }\n\t\t\t\tclassName=\"components-drop-zone__content\"\n\t\t\t\t// Without this, when this div is shown,\n\t\t\t\t// Safari calls a onDropZoneLeave causing a loop because of this bug\n\t\t\t\t// https://bugs.webkit.org/show_bug.cgi?id=66547\n\t\t\t\tstyle={ { pointerEvents: 'none' } }\n\t\t\t>\n\t\t\t\t<motion.div variants={ foreground }>\n\t\t\t\t\t<Icon\n\t\t\t\t\t\ticon={ upload }\n\t\t\t\t\t\tclassName=\"components-drop-zone__content-icon\"\n\t\t\t\t\t/>\n\t\t\t\t\t<span className=\"components-drop-zone__content-text\">\n\t\t\t\t\t\t{ label ? label : __( 'Drop files to upload' ) }\n\t\t\t\t\t</span>\n\t\t\t\t</motion.div>\n\t\t\t</motion.div>\n\t\t);\n\t}\n\n\tconst classes = classnames( 'components-drop-zone', className, {\n\t\t'is-active':\n\t\t\t( isDraggingOverDocument || isDraggingOverElement ) &&\n\t\t\t( ( type === 'file' && onFilesDrop ) ||\n\t\t\t\t( type === 'html' && onHTMLDrop ) ||\n\t\t\t\t( type === 'default' && onDrop ) ),\n\t\t'is-dragging-over-document': isDraggingOverDocument,\n\t\t'is-dragging-over-element': isDraggingOverElement,\n\t\t[ `is-dragging-${ type }` ]: !! type,\n\t} );\n\n\treturn (\n\t\t<div { ...restProps } ref={ ref } className={ classes }>\n\t\t\t{ disableMotion ? (\n\t\t\t\tchildren\n\t\t\t) : (\n\t\t\t\t<AnimatePresence>{ children }</AnimatePresence>\n\t\t\t) }\n\t\t</div>\n\t);\n}\n\nexport default DropZoneComponent;\n"]}