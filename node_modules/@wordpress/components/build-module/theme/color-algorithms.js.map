{"version":3,"sources":["@wordpress/components/src/theme/color-algorithms.ts"],"names":["colord","extend","a11yPlugin","namesPlugin","warning","COLORS","generateThemeVariables","inputs","validateInputs","generatedColors","generateAccentDependentColors","accent","generateBackgroundDependentColors","background","warnContrastIssues","checkContrasts","colors","key","value","Object","entries","isValid","outputs","white","foreground","gray","isReadable","undefined","grays","contrast","issues","error","values","accentDarker10","darken","toHex","accentDarker20","accentInverted","getForegroundForColor","foregroundInverted","generateShades","color","isDark","SHADES","limit","direction","range","Math","abs","toHsl","l","result","forEach","parseInt"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { colord, extend } from 'colord';\nimport a11yPlugin from 'colord/plugins/a11y';\nimport namesPlugin from 'colord/plugins/names';\n\n/**\n * WordPress dependencies\n */\nimport warning from '@wordpress/warning';\n\n/**\n * Internal dependencies\n */\nimport type { ThemeInputValues, ThemeOutputValues } from './types';\nimport { COLORS } from '../utils';\n\nextend( [ namesPlugin, a11yPlugin ] );\n\nexport function generateThemeVariables(\n\tinputs: ThemeInputValues\n): ThemeOutputValues {\n\tvalidateInputs( inputs );\n\n\tconst generatedColors = {\n\t\t...generateAccentDependentColors( inputs.accent ),\n\t\t...generateBackgroundDependentColors( inputs.background ),\n\t};\n\n\twarnContrastIssues( checkContrasts( inputs, generatedColors ) );\n\n\treturn { colors: generatedColors };\n}\n\nfunction validateInputs( inputs: ThemeInputValues ) {\n\tfor ( const [ key, value ] of Object.entries( inputs ) ) {\n\t\tif ( typeof value !== 'undefined' && ! colord( value ).isValid() ) {\n\t\t\twarning(\n\t\t\t\t`wp.components.Theme: \"${ value }\" is not a valid color value for the '${ key }' prop.`\n\t\t\t);\n\t\t}\n\t}\n}\n\nexport function checkContrasts(\n\tinputs: ThemeInputValues,\n\toutputs: ThemeOutputValues[ 'colors' ]\n) {\n\tconst background = inputs.background || COLORS.white;\n\tconst accent = inputs.accent || '#007cba';\n\tconst foreground = outputs.foreground || COLORS.gray[ 900 ];\n\tconst gray = outputs.gray || COLORS.gray;\n\n\treturn {\n\t\taccent: colord( background ).isReadable( accent )\n\t\t\t? undefined\n\t\t\t: `The background color (\"${ background }\") does not have sufficient contrast against the accent color (\"${ accent }\").`,\n\t\tforeground: colord( background ).isReadable( foreground )\n\t\t\t? undefined\n\t\t\t: `The background color provided (\"${ background }\") does not have sufficient contrast against the standard foreground colors.`,\n\t\tgrays:\n\t\t\tcolord( background ).contrast( gray[ 600 ] ) >= 3 &&\n\t\t\tcolord( background ).contrast( gray[ 700 ] ) >= 4.5\n\t\t\t\t? undefined\n\t\t\t\t: `The background color provided (\"${ background }\") cannot generate a set of grayscale foreground colors with sufficient contrast. Try adjusting the color to be lighter or darker.`,\n\t};\n}\n\nfunction warnContrastIssues( issues: ReturnType< typeof checkContrasts > ) {\n\tfor ( const error of Object.values( issues ) ) {\n\t\tif ( error ) {\n\t\t\twarning( 'wp.components.Theme: ' + error );\n\t\t}\n\t}\n}\n\nfunction generateAccentDependentColors( accent?: string ) {\n\tif ( ! accent ) return {};\n\n\treturn {\n\t\taccent,\n\t\taccentDarker10: colord( accent ).darken( 0.1 ).toHex(),\n\t\taccentDarker20: colord( accent ).darken( 0.2 ).toHex(),\n\t\taccentInverted: getForegroundForColor( accent ),\n\t};\n}\n\nfunction generateBackgroundDependentColors( background?: string ) {\n\tif ( ! background ) return {};\n\n\tconst foreground = getForegroundForColor( background );\n\n\treturn {\n\t\tbackground,\n\t\tforeground,\n\t\tforegroundInverted: getForegroundForColor( foreground ),\n\t\tgray: generateShades( background, foreground ),\n\t};\n}\n\nfunction getForegroundForColor( color: string ) {\n\treturn colord( color ).isDark() ? COLORS.white : COLORS.gray[ 900 ];\n}\n\nexport function generateShades( background: string, foreground: string ) {\n\t// How much darkness you need to add to #fff to get the COLORS.gray[n] color\n\tconst SHADES = {\n\t\t100: 0.06,\n\t\t200: 0.121,\n\t\t300: 0.132,\n\t\t400: 0.2,\n\t\t600: 0.42,\n\t\t700: 0.543,\n\t\t800: 0.821,\n\t};\n\n\t// Darkness of COLORS.gray[ 900 ], relative to #fff\n\tconst limit = 0.884;\n\n\tconst direction = colord( background ).isDark() ? 'lighten' : 'darken';\n\n\t// Lightness delta between the background and foreground colors\n\tconst range =\n\t\tMath.abs(\n\t\t\tcolord( background ).toHsl().l - colord( foreground ).toHsl().l\n\t\t) / 100;\n\n\tconst result: Record< number, string > = {};\n\n\tObject.entries( SHADES ).forEach( ( [ key, value ] ) => {\n\t\tresult[ parseInt( key ) ] = colord( background )\n\t\t\t[ direction ]( ( value / limit ) * range )\n\t\t\t.toHex();\n\t} );\n\n\treturn result as NonNullable< ThemeOutputValues[ 'colors' ][ 'gray' ] >;\n}\n"]}