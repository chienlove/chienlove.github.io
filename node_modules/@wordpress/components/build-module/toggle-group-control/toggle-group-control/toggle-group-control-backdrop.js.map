{"version":3,"sources":["@wordpress/components/src/toggle-group-control/toggle-group-control/toggle-group-control-backdrop.tsx"],"names":["useState","useEffect","memo","BackdropView","ToggleGroupControlBackdrop","containerRef","containerWidth","isAdaptiveWidth","state","left","setLeft","width","setWidth","canAnimate","setCanAnimate","renderBackdrop","setRenderBackdrop","containerNode","current","targetNode","querySelector","computeDimensions","offsetWidth","x","getBoundingClientRect","parentX","borderWidth","offsetLeft","dimensionsRequestId","window","setTimeout","animationRequestId","requestAnimationFrame","clearTimeout","cancelAnimationFrame","transform","transition","undefined"],"mappings":";;AAAA;AACA;AACA;AACA,SAASA,QAAT,EAAmBC,SAAnB,EAA8BC,IAA9B,QAA0C,oBAA1C;AAEA;AACA;AACA;;AAEA,SAASC,YAAT,QAA6B,UAA7B;;AAEA,SAASC,0BAAT,OAKqC;AAAA,MALA;AACpCC,IAAAA,YADoC;AAEpCC,IAAAA,cAFoC;AAGpCC,IAAAA,eAHoC;AAIpCC,IAAAA;AAJoC,GAKA;AACpC,QAAM,CAAEC,IAAF,EAAQC,OAAR,IAAoBV,QAAQ,CAAE,CAAF,CAAlC;AACA,QAAM,CAAEW,KAAF,EAASC,QAAT,IAAsBZ,QAAQ,CAAE,CAAF,CAApC;AACA,QAAM,CAAEa,UAAF,EAAcC,aAAd,IAAgCd,QAAQ,CAAE,KAAF,CAA9C;AACA,QAAM,CAAEe,cAAF,EAAkBC,iBAAlB,IAAwChB,QAAQ,CAAE,KAAF,CAAtD;AAEAC,EAAAA,SAAS,CAAE,MAAM;AAChB,UAAMgB,aAAa,GAAGZ,YAAH,aAAGA,YAAH,uBAAGA,YAAY,CAAEa,OAApC;AACA,QAAK,CAAED,aAAP,EAAuB;AAEvB;AACF;AACA;;AACE,UAAME,UAAU,GAAGF,aAAa,CAACG,aAAd,CACjB,gBAAgBZ,KAAO,IADN,CAAnB;AAGAQ,IAAAA,iBAAiB,CAAE,CAAC,CAAEG,UAAL,CAAjB;;AACA,QAAK,CAAEA,UAAP,EAAoB;AACnB;AACA;;AAED,UAAME,iBAAiB,GAAG,MAAM;AAC/B,YAAM;AAAEV,QAAAA,KAAK,EAAEW,WAAT;AAAsBC,QAAAA;AAAtB,UACLJ,UAAU,CAACK,qBAAX,EADD;AAGA,YAAM;AAAED,QAAAA,CAAC,EAAEE;AAAL,UAAiBR,aAAa,CAACO,qBAAd,EAAvB;AAEA,YAAME,WAAW,GAAG,CAApB;AACA,YAAMC,UAAU,GAAGJ,CAAC,GAAGE,OAAJ,GAAcC,WAAjC;AAEAhB,MAAAA,OAAO,CAAEiB,UAAF,CAAP;AACAf,MAAAA,QAAQ,CAAEU,WAAF,CAAR;AACA,KAXD,CAfgB,CA2BhB;AACA;AACA;AACA;;;AACA,UAAMM,mBAAmB,GAAGC,MAAM,CAACC,UAAP,CAAmBT,iBAAnB,EAAsC,GAAtC,CAA5B;AAEA,QAAIU,kBAAJ;;AACA,QAAK,CAAElB,UAAP,EAAoB;AACnBkB,MAAAA,kBAAkB,GAAGF,MAAM,CAACG,qBAAP,CAA8B,MAAM;AACxDlB,QAAAA,aAAa,CAAE,IAAF,CAAb;AACA,OAFoB,CAArB;AAGA;;AACD,WAAO,MAAM;AACZe,MAAAA,MAAM,CAACI,YAAP,CAAqBL,mBAArB;AACAC,MAAAA,MAAM,CAACK,oBAAP,CAA6BH,kBAA7B;AACA,KAHD;AAIA,GA3CQ,EA2CN,CAAElB,UAAF,EAAcR,YAAd,EAA4BC,cAA5B,EAA4CE,KAA5C,EAAmDD,eAAnD,CA3CM,CAAT;;AA6CA,MAAK,CAAEQ,cAAP,EAAwB;AACvB,WAAO,IAAP;AACA;;AAED,SACC,cAAC,YAAD;AACC,IAAA,IAAI,EAAC,cADN;AAEC,IAAA,KAAK,EAAG;AACPoB,MAAAA,SAAS,EAAG,cAAc1B,IAAM,KADzB;AAEP2B,MAAAA,UAAU,EAAEvB,UAAU,GAAGwB,SAAH,GAAe,MAF9B;AAGP1B,MAAAA;AAHO;AAFT,IADD;AAUA;;AAED,eAAeT,IAAI,CAAEE,0BAAF,CAAnB","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useState, useEffect, memo } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport type { ToggleGroupControlBackdropProps } from '../types';\nimport { BackdropView } from './styles';\n\nfunction ToggleGroupControlBackdrop( {\n\tcontainerRef,\n\tcontainerWidth,\n\tisAdaptiveWidth,\n\tstate,\n}: ToggleGroupControlBackdropProps ) {\n\tconst [ left, setLeft ] = useState( 0 );\n\tconst [ width, setWidth ] = useState( 0 );\n\tconst [ canAnimate, setCanAnimate ] = useState( false );\n\tconst [ renderBackdrop, setRenderBackdrop ] = useState( false );\n\n\tuseEffect( () => {\n\t\tconst containerNode = containerRef?.current;\n\t\tif ( ! containerNode ) return;\n\n\t\t/**\n\t\t * Workaround for Reakit\n\t\t */\n\t\tconst targetNode = containerNode.querySelector(\n\t\t\t`[data-value=\"${ state }\"]`\n\t\t);\n\t\tsetRenderBackdrop( !! targetNode );\n\t\tif ( ! targetNode ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst computeDimensions = () => {\n\t\t\tconst { width: offsetWidth, x } =\n\t\t\t\ttargetNode.getBoundingClientRect();\n\n\t\t\tconst { x: parentX } = containerNode.getBoundingClientRect();\n\n\t\t\tconst borderWidth = 1;\n\t\t\tconst offsetLeft = x - parentX - borderWidth;\n\n\t\t\tsetLeft( offsetLeft );\n\t\t\tsetWidth( offsetWidth );\n\t\t};\n\t\t// Fix to make the component appear as expected inside popovers.\n\t\t// If the targetNode width is 0 it means the element was not yet rendered we should allow\n\t\t// some time for the render to happen.\n\t\t// requestAnimationFrame instead of setTimeout with a small time does not seems to work.\n\t\tconst dimensionsRequestId = window.setTimeout( computeDimensions, 100 );\n\n\t\tlet animationRequestId: number;\n\t\tif ( ! canAnimate ) {\n\t\t\tanimationRequestId = window.requestAnimationFrame( () => {\n\t\t\t\tsetCanAnimate( true );\n\t\t\t} );\n\t\t}\n\t\treturn () => {\n\t\t\twindow.clearTimeout( dimensionsRequestId );\n\t\t\twindow.cancelAnimationFrame( animationRequestId );\n\t\t};\n\t}, [ canAnimate, containerRef, containerWidth, state, isAdaptiveWidth ] );\n\n\tif ( ! renderBackdrop ) {\n\t\treturn null;\n\t}\n\n\treturn (\n\t\t<BackdropView\n\t\t\trole=\"presentation\"\n\t\t\tstyle={ {\n\t\t\t\ttransform: `translateX(${ left }px)`,\n\t\t\t\ttransition: canAnimate ? undefined : 'none',\n\t\t\t\twidth,\n\t\t\t} }\n\t\t/>\n\t);\n}\n\nexport default memo( ToggleGroupControlBackdrop );\n"]}