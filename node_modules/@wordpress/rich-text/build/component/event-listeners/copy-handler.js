"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _toHtmlString = require("../../to-html-string");
var _isCollapsed = require("../../is-collapsed");
var _slice = require("../../slice");
var _getTextContent = require("../../get-text-content");
/**
 * Internal dependencies
 */
var _default = props => element => {
  function onCopy(event) {
    const {
      record
    } = props.current;
    const {
      ownerDocument
    } = element;
    if ((0, _isCollapsed.isCollapsed)(record.current) || !element.contains(ownerDocument.activeElement)) {
      return;
    }
    const selectedRecord = (0, _slice.slice)(record.current);
    const plainText = (0, _getTextContent.getTextContent)(selectedRecord);
    const html = (0, _toHtmlString.toHTMLString)({
      value: selectedRecord
    });
    event.clipboardData.setData('text/plain', plainText);
    event.clipboardData.setData('text/html', html);
    event.clipboardData.setData('rich-text', 'true');
    event.preventDefault();
    if (event.type === 'cut') {
      ownerDocument.execCommand('delete');
    }
  }
  const {
    defaultView
  } = element.ownerDocument;
  defaultView.addEventListener('copy', onCopy);
  defaultView.addEventListener('cut', onCopy);
  return () => {
    defaultView.removeEventListener('copy', onCopy);
    defaultView.removeEventListener('cut', onCopy);
  };
};
exports.default = _default;
//# sourceMappingURL=copy-handler.js.map