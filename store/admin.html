 <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Page</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>Admin Page</h1>
    </header>
    <main>
        <form id="post-form">
            <label for="app-name">Tên ứng dụng:</label>
            <input type="text" id="app-name" name="app-name" required><br>

            <label for="app-icon">Icon ứng dụng (URL):</label>
            <input type="url" id="app-icon" name="app-icon" required><br>

            <label for="app-screenshots">Ảnh màn hình ứng dụng (URL):</label>
            <input type="url" id="app-screenshot" name="app-screenshot" required>
            <button type="button" id="add-screenshot">Thêm ảnh</button><br>
            
            <div id="screenshots-preview"></div>

            <label for="description">Mô tả ứng dụng:</label>
            <textarea id="description" name="description" required></textarea><br>

            <label for="developer">Nhà phát triển:</label>
            <input type="text" id="developer" name="developer" required><br>

            <label for="ios-version">Phiên bản iOS tương thích:</label>
            <input type="text" id="ios-version" name="ios-version" required><br>

            <label for="app-version">Phiên bản của ứng dụng:</label>
            <input type="text" id="app-version" name="app-version" required><br>

            <label for="category">Danh mục:</label>
            <input type="text" id="category" name="category" required><br>

            <label for="download-link">Liên kết tải xuống ứng dụng:</label>
            <input type="url" id="download-link" name="download-link" required><br>

            <button type="submit">Submit</button>
        </form>

        <h2>Quản lý bài viết</h2>
        <table id="posts-table">
            <thead>
                <tr>
                    <th>Tên ứng dụng</th>
                    <th>Nhà phát triển</th>
                    <th>Chỉnh sửa</th>
                    <th>Xóa</th>
                </tr>
            </thead>
            <tbody>
                <!-- Các bài viết sẽ được hiển thị tại đây -->
            </tbody>
        </table>
    </main>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('post-form');
            const screenshotsPreview = document.getElementById('screenshots-preview');
            const addScreenshotButton = document.getElementById('add-screenshot');

            addScreenshotButton.addEventListener('click', () => {
                const screenshotInput = document.createElement('input');
                screenshotInput.type = 'url';
                screenshotInput.name = 'app-screenshot';
                screenshotInput.placeholder = 'URL ảnh màn hình';
                screenshotsPreview.appendChild(screenshotInput);
            });

            // Function to load and manage posts
            const loadPosts = () => {
                const posts = JSON.parse(localStorage.getItem('posts')) || [];
                const postsTableBody = document.querySelector('#posts-table tbody');
                postsTableBody.innerHTML = '';

                posts.forEach((post, index) => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${post.app_name}</td>
                        <td>${post.developer}</td>
                        <td><button data-index="${index}" class="edit-button">Chỉnh sửa</button></td>
                        <td><button data-index="${index}" class="delete-button">Xóa</button></td>
                    `;
                    postsTableBody.appendChild(row);
                });

                document.querySelectorAll('.edit-button').forEach(button => {
                    button.addEventListener('click', (event) => {
                        const index = event.target.getAttribute('data-index');
                        editPost(index);
                    });
                });

                document.querySelectorAll('.delete-button').forEach(button => {
                    button.addEventListener('click', (event) => {
                        const index = event.target.getAttribute('data-index');
                        deletePost(index);
                    });
                });
            };

            // Function to edit a post
            const editPost = (index) => {
                const posts = JSON.parse(localStorage.getItem('posts')) || [];
                const post = posts[index];

                document.getElementById('app-name').value = post.app_name;
                document.getElementById('app-icon').value = post.app_icon;
                document.getElementById('description').value = post.description;
                document.getElementById('developer').value = post.developer;
                document.getElementById('ios-version').value = post.ios_version;
                document.getElementById('app-version').value = post.app_version;
                document.getElementById('category').value = post.category;
                document.getElementById('download-link').value = post.download_link;

                screenshotsPreview.innerHTML = '';
                post.app_screenshots.forEach(url => {
                    const screenshotInput = document.createElement('input');
                    screenshotInput.type = 'url';
                    screenshotInput.name = 'app-screenshot';
                    screenshotInput.value = url;
                    screenshotsPreview.appendChild(screenshotInput);
                });

                form.dataset.editIndex = index;
            };

            // Function to delete a post
            const deletePost = (index) => {
                let posts = JSON.parse(localStorage.getItem('posts')) || [];
                posts.splice(index, 1);
                localStorage.setItem('posts', JSON.stringify(posts));
                loadPosts();
            };

            // Form submit event listener
            form.addEventListener('submit', (event) => {
                event.preventDefault();
                const appName = document.getElementById('app-name').value;
                const appIcon = document.getElementById('app-icon').value;
                const description = document.getElementById('description').value;
                const developer = document.getElementById('developer').value;
                const iosVersion = document.getElementById('ios-version').value;
                const appVersion = document.getElementById('app-version').value;
                const category = document.getElementById('category').value;
                const downloadLink = document.getElementById('download-link').value;

                const appScreenshots = Array.from(screenshotsPreview.querySelectorAll('input')).map(input => input.value);

                const newPost = {
                    app_name: appName,
                    app_icon: appIcon,
                    app_screenshots: appScreenshots,
                    description,
                    developer,
                    ios_version: iosVersion,
                    app_version: appVersion,
                    category,
                    download_link: downloadLink
                };

                let posts = JSON.parse(localStorage.getItem('posts')) || [];

                const editIndex = form.dataset.editIndex;
                if (editIndex) {
                    posts[editIndex] = newPost;
                    delete form.dataset.editIndex;
                } else {
                    posts.push(newPost);
                }

                localStorage.setItem('posts', JSON.stringify(posts));

                form.reset();
                screenshotsPreview.innerHTML = '';
                alert('Post saved successfully!');
                loadPosts();
            });

            // Initial load of posts
            loadPosts();
        });
    </script>
</body>
</html>