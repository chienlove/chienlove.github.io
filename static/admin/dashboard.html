<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Content Manager</title>
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
</head>
<body>
  <!-- Include the script that builds the page and powers Netlify CMS -->
  <script src="https://unpkg.com/netlify-cms@^2.10.192/dist/netlify-cms.js"></script>
  
  <script>
    const UpdateSizeControl = createClass({
  getInitialState() {
    return {
      inputValue: this.props.value || '',
    };
  },

  handleInputChange(e) {
    this.setState({ inputValue: e.target.value });
  },

  handleUpdateSize: async function() {
    const plistUrl = document.querySelector('[name="main_download.plistUrl"]').value;
    if (!plistUrl) {
      alert('Vui lòng nhập URL Plist trước');
      return;
    }

    try {
      const fileSize = await fetchFileSize(plistUrl);
      if (fileSize) {
        this.props.onChange(fileSize);
        this.setState({ inputValue: fileSize });
        alert('Kích thước đã được cập nhật: ' + fileSize);
      } else {
        alert('Không thể cập nhật kích thước file');
      }
    } catch (error) {
      console.error('Lỗi khi cập nhật kích thước:', error);
      alert('Đã xảy ra lỗi khi cập nhật kích thước');
    }
  },

  render: function() {
    const { forID, classNameWrapper } = this.props;
    return h('div', { className: classNameWrapper },
      h('input', {
        type: 'text',
        id: forID,
        className: 'update-size-input',
        value: this.state.inputValue,
        onChange: this.handleInputChange,
        style: { width: '200px' }  // Giới hạn chiều rộng của input
      }),
      h('button', {
        className: 'update-size-button',
        onClick: this.handleUpdateSize,
        style: { marginLeft: '10px' }
      }, 'Cập nhật kích thước')
    );
  }
});

CMS.registerWidget('update-size', UpdateSizeControl);

    // Khởi tạo CMS
    CMS.init();
  </script>
</body>
</html>