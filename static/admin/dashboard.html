<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>StoreiOS CMS</title>
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  <link rel="stylesheet" href="/css/admin.css?ver=1.0">
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Force mobile class immediately
      if (window.innerWidth < 768) {
        document.body.classList.add('mobile-view');
        console.log('Mobile view activated');
      }
      
      // Listen for CMS init event
      document.addEventListener('netlify-cms-loaded', function() {
        console.log('CMS fully loaded');
        // Re-check mobile state after CMS init
        if (window.innerWidth < 768) {
          document.documentElement.classList.add('cms-mobile');
          document.body.classList.add('mobile-view');
        }
      });
    });
    
    // Continuous resize checking
    window.addEventListener('resize', function() {
      if (window.innerWidth < 768) {
        document.body.classList.add('mobile-view');
        document.documentElement.classList.add('cms-mobile');
      } else {
        document.body.classList.remove('mobile-view');
        document.documentElement.classList.remove('cms-mobile');
      }
    });
  </script>
</head>
<body>
  <script src="https://unpkg.com/netlify-cms@^2.0.0/dist/netlify-cms.js"></script>
  <script src="/admin/widgets/updateSize.js"></script>
  <script src="/admin/widgets/customCard.js"></script>
</body>
</html>